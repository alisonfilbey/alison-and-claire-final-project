---
title: "Final Project"
format: html
---


```{python}
import pandas as pd
import geopandas as gpd
from shapely import wkt

crashes = pd.read_csv("Data/Traffic_Crashes_Crashes.csv")
```

```{python}
#loading the crashes - people data
crashes_people = pd.read_csv(r'Data\Traffic_Crashes_People.csv', low_memory=False)
crashes_crashes_people = pd.merge(crashes, crashes_people, on = 'CRASH_RECORD_ID')

```

```{python}
#clean crashes data

#drop missing and outlier locations
crashes = crashes[crashes["LATITUDE"] != 0]
crashes = crashes[crashes["LOCATION"].notna()]

#create geometry column to turn into geopandas object
crashes["LOCATION"] = crashes["LOCATION"].apply(wkt.loads)
crashes_gdf = gpd.GeoDataFrame(crashes, geometry="LOCATION")

#set crs
crashes_gdf = crashes_gdf.set_crs("EPSG:4326", inplace=True)
```


```{python}
#plot data to see what it looks like
crashes_gdf.plot()
```

```{python}
#checking for duplicates
#crashes_crashes_people.duplicated().sum()
#data_types = crashes_crashes_people.dtypes
number_of_crashes = crashes_crashes_people.groupby('CRASH_RECORD_ID').size().reset_index()
number_of_crashes_zipcode = crashes_crashes_people.groupby(['ZIPCODE','CRASH_RECORD_ID']).size().reset_index()
number_of_people_zipcode = crashes_crashes_people.groupby(['ZIPCODE']).size().reset_index()
```
